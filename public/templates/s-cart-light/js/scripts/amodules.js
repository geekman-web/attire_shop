/**
 * @module  αUtil
 * @version v1.0.1
 * @desc    Service functions for α-modules
 * @author  OXAYAZA {@link https://github.com/OXAYAZA}
 * @license CC BY-SA 4.0 {@link https://creativecommons.org/licenses/by-sa/4.0/}
 * @see     {@link https://www.linkedin.com/in/%D1%8E%D1%80%D0%B8%D0%B9-%D0%B1%D0%B0%D0%B7%D0%B0%D0%B5%D0%B2-166479165/}
 */
function Util(){}Util.inViewport=function(element,cb){var rect=element.getBoundingClientRect(),inView=rect.top<window.innerHeight&&rect.bottom>0;if(cb instanceof Function&&inView)cb();return inView};Util.merge=function(sources,options){options=options||{};var initial={};for(var s=0;s<sources.length;s++){var source=sources[s];if(!source)continue;for(var key in source){if(options.except&&!options.except.indexOf(key)){continue}else if(source[key]instanceof Object&&!(source[key]instanceof Node)&&!(source[key]instanceof Function)){initial[key]=Util.merge([initial[key],source[key]],options)}else if(options.skipNull&&source[key]===null){continue}else{initial[key]=source[key]}}}return initial};Util.uId=function(length){var uId="";for(var i=0;i<length;i++){uId+=String.fromCharCode(97+Math.random()*25)}return uId};
/**
 * @module   αCounter
 * @version  v0.1.1
 * @author   OXAYAZA {@link https://github.com/OXAYAZA}
 * @license  CC BY-SA 4.0 {@link https://creativecommons.org/licenses/by-sa/4.0/}
 * @requires module:αUtil
 * @see      {@link https://oxayaza.page.link/gitHub_aCounters}
 */
function aCounter(data){function Counter(data){if(!data||!data.node)throw Error('Missing required aCounter parameters (node).');this.params=Util.merge([this.defaults,data]);this.params.node.counter=this;if(!this.params.to){try{this.params.to=parseInt(this.params.node.textContent,10)}catch(error){throw Error('Unable to get aCounter value')}}this.run=this.run.bind(this);return this}Counter.prototype.internal={intervalId:null,value:0,loops:0,increment:0,loop:0};Counter.prototype.defaults={node:null,from:0,to:null,duration:3000,refresh:30,formatter:null,onStart:null,onUpdate:null,onComplete:null};Counter.prototype.run=function(){clearInterval(this.internal.intervalId);this.internal.value=this.params.from;this.internal.loops=Math.ceil(this.params.duration/this.params.refresh);this.internal.increment=(this.params.to-this.params.from)/this.internal.loops;this.internal.loop=0;if(this.params.onStart instanceof Function)this.params.onStart.call(this,~~this.internal.value);this.internal.intervalId=setInterval(this.update.bind(this),this.params.refresh)};Counter.prototype.update=function(){this.internal.value+=this.internal.increment;this.internal.loop++;if(this.params.onUpdate instanceof Function)this.params.onUpdate.call(this,~~this.internal.value);if(this.internal.loop>=this.internal.loops){clearInterval(this.internal.intervalId);this.internal.value=this.params.to;if(this.params.onComplete instanceof Function)this.params.onComplete.call(this,~~this.internal.value)}this.render()};Counter.prototype.render=function(){if(this.params.formatter instanceof Function){this.params.node.innerHTML=this.params.formatter.call(this,~~this.internal.value)}else{this.params.node.innerHTML=~~this.internal.value}};return new Counter(data)}

/**
 * @module   αProgressCircle
 * @version  v0.1.1
 * @author   OXAYAZA {@link https://github.com/OXAYAZA}
 * @license  CC BY-SA 4.0 {@link https://creativecommons.org/licenses/by-sa/4.0/}
 * @requires module:αUtil
 * @see      {@link https://oxayaza.page.link/gitHub_aCounters}
 */
function aProgressCircle(data){function Circle(data){if(!data||!data.node)throw Error('Missing required \u03B1ProgressCircle parameters (node).');this.params=Util.merge([this.defaults,data]);this.params.node.progressCircle=this;this.internal.clipPath=document.createElementNS('http://www.w3.org/2000/svg','clipPath');this.internal.clipPath.id=this.params.clipId;this.params.node.appendChild(this.internal.clipPath);this.internal.path=document.createElementNS('http://www.w3.org/2000/svg','path');this.internal.path.setAttribute('d',this.internal.pathD);this.internal.clipPath.appendChild(this.internal.path);this.internal.clipped=this.params.node.querySelector(this.params.clipped);this.internal.clipped.setAttribute('clip-path','url(#'+this.params.clipId+')');this.internal.viewBox=this.params.node.getAttribute('viewBox').split(' ').map(function(value){return parseFloat(value)});this.internal.ellipse.rx=this.internal.viewBox[2]/2*1.44;this.internal.ellipse.ry=this.internal.viewBox[3]/2*1.44;this.internal.ellipse.cx=this.internal.viewBox[0]+this.internal.viewBox[2]/2;this.internal.ellipse.cy=this.internal.viewBox[1]+this.internal.viewBox[3]/2;this.render(this.params.angle)}Circle.prototype.internal={viewBox:[0,0,100,100],ellipse:{rx:72,ry:72,cx:50,cy:50},x:0,y:0,clipped:null,clipPath:null,path:null,pathD:''};Circle.prototype.defaults={node:null,clipped:'.clipped',clipId:Util.uId(8),angle:0};Circle.prototype.calc=function(){this.internal.x=Math.sin(this.params.angle*Math.PI/180)*this.internal.ellipse.rx+this.internal.ellipse.cx;this.internal.y=-Math.cos(this.params.angle*Math.PI/180)*this.internal.ellipse.ry+this.internal.ellipse.cy};Circle.prototype.genPath=function(){if(this.params.angle>=-360&&this.params.angle<-180){this.internal.pathD='M '+this.internal.ellipse.cx+' '+this.internal.ellipse.cy+' L '+this.internal.x+' '+this.internal.y+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy+this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)}else if(this.params.angle>=-180&&this.params.angle<0){this.internal.pathD='M '+this.internal.ellipse.cx+' '+this.internal.ellipse.cy+' L '+this.internal.x+' '+this.internal.y+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)}else if(this.params.angle>=0&&this.params.angle<180){this.internal.pathD='M '+this.internal.ellipse.cx+' '+this.internal.ellipse.cy+' L '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.x+' '+this.internal.y}else if(this.params.angle>=180&&this.params.angle<=360){this.internal.pathD='M '+this.internal.ellipse.cx+' '+this.internal.ellipse.cy+' L '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy+this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.x+' '+this.internal.y}else{this.internal.pathD='M '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy+this.internal.ellipse.ry)+' A '+this.internal.ellipse.rx+' '+this.internal.ellipse.ry+' 0 0 1 '+this.internal.ellipse.cx+' '+(this.internal.ellipse.cy-this.internal.ellipse.ry)}};Circle.prototype.render=function(angle){if(typeof angle==='number')this.params.angle=angle;this.calc();this.genPath();this.internal.path.setAttribute('d',this.internal.pathD)};return new Circle(data)}

/**
 * @module   αCountdown
 * @version  v0.1.1
 * @author   OXAYAZA {@link https://github.com/OXAYAZA}
 * @license  CC BY-SA 4.0 {@link https://creativecommons.org/licenses/by-sa/4.0/}
 * @requires module:αUtil
 * @requires module:αProgressCircle
 * @see      {@link https://oxayaza.page.link/gitHub_aCounters}
 */
function aCountdown(data){function Countdown(data){if(!data||!data.node||typeof data.to==='undefined'){throw Error('Missing of bad required \u03B1Countdown parameters (node, from, to).')}this.params=Util.merge([this.defaults,data],{skipNull:true});this.params.node.countdown=this;this.internal.to=Number(new Date(this.params.to));this.internal.from=this.params.from?Number(new Date(this.params.from)):this.internal.to-this.constant.year;for(var key in this.internal.counters){this.internal.counters[key]=this.params.node.querySelector('[data-counter-'+key+']')}for(var key in this.internal.circles){this.internal.circles[key]=this.params.node.querySelector('[data-progress-'+key+']');if(this.internal.circles[key])aProgressCircle({node:this.internal.circles[key]})}this.run()}Countdown.prototype.defaults={from:null,to:null,tick:1000,count:'auto',onTick:null};Countdown.prototype.constant={second:1000,minute:1000*60,hour:1000*60*60,day:1000*60*60*24,year:1000*60*60*24*365};Countdown.prototype.internal={from:null,to:null,now:null,counters:{days:null,hours:null,minutes:null,seconds:null},circles:{days:null,hours:null,minutes:null,seconds:null},period:{full:null,now:null},time:{days:null,hours:null,minutes:null,seconds:null},angle:{days:null,hours:null,minutes:null,seconds:null},tmp:{days:null,hours:null,minutes:null}};Countdown.prototype.calc=function(){this.internal.time.days=this.internal.period.now/this.constant.day;this.internal.angle.days=360/~~(this.internal.period.full/this.constant.day)*~~this.internal.time.days||0;this.internal.tmp.days=~~this.internal.time.days*this.constant.day;this.internal.time.hours=(this.internal.period.now-this.internal.tmp.days)/this.constant.hour;this.internal.angle.hours=360/24*this.internal.time.hours;this.internal.tmp.hours=~~this.internal.time.hours*this.constant.hour;this.internal.time.minutes=(this.internal.period.now-(this.internal.tmp.days+this.internal.tmp.hours))/this.constant.minute;this.internal.angle.minutes=360/60*this.internal.time.minutes;this.internal.tmp.minutes=~~this.internal.time.minutes*this.constant.minute;this.internal.time.seconds=(this.internal.period.now-(this.internal.tmp.days+this.internal.tmp.hours+this.internal.tmp.minutes))/this.constant.second;this.internal.angle.seconds=360/60*this.internal.time.seconds};Countdown.prototype.mode=function(){this.internal.now=Number(new Date);if(this.internal.to>this.internal.now&&['auto','until'].indexOf(this.params.count)>-1){this.internal.period.full=this.internal.to-this.internal.from;this.internal.period.now=this.internal.to-this.internal.now}else if(this.internal.to<this.internal.now&&['auto','since'].indexOf(this.params.count)>-1){this.internal.period.full=this.internal.to-this.internal.from;this.internal.period.now=this.internal.now-this.internal.to}};Countdown.prototype.render=function(){this.mode();this.calc();for(var key in this.internal.counters){if(this.internal.counters[key])this.internal.counters[key].innerText=~~this.internal.time[key];if(this.internal.circles[key])this.internal.circles[key].progressCircle.render(this.internal.angle[key])}};Countdown.prototype.run=function(){this.render();setInterval(function(){this.render();if(this.params.onTick instanceof Function)this.params.onTick.call(this)}.bind(this),this.params.tick)};return new Countdown(data)}
